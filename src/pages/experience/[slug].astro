---
import Layout from "../../layouts/Layout.astro";
import { getCollection } from "astro:content";
import { ArrowLeft } from "lucide-astro";

export async function getStaticPaths() {
  const caseStudies = await getCollection("portfolio");
  return caseStudies.map((study) => ({
    params: { slug: study.slug },
    props: { study },
  }));
}

const { study } = Astro.props;
const { Content } = await study.render();
---

<Layout title={`${study.data.company} | Experience | Gauges Green`} description={study.data.challenge}>
  <main class="min-h-screen bg-white dark:bg-[#0a0a0a]">
    <!-- Back link -->
    <div class="pt-8 px-6 md:px-8 max-w-2xl mx-auto">
      <a
        href="/experience"
        class="inline-flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors"
      >
        <ArrowLeft class="w-4 h-4" />
        Back to Experience
      </a>
    </div>

    <!-- Header -->
    <section class="pt-6 pb-8 px-6 md:px-8 max-w-2xl mx-auto">
      <div class="flex items-center gap-3 mb-2">
        <h1 class="text-3xl font-semibold text-gray-900 dark:text-white">
          {study.data.company}
        </h1>
        <span class="text-sm text-gray-500 dark:text-gray-500">
          {study.data.period}
        </span>
      </div>
      <p class="text-sm text-primary mb-4">{study.data.role}</p>

      <!-- Hero Metric -->
      <div class="p-6 border border-gray-200 dark:border-gray-800">
        <p class="text-xl font-semibold text-gray-900 dark:text-white">
          {study.data.heroMetric}
        </p>
        <p class="text-sm text-gray-500 dark:text-gray-500">
          {study.data.heroMetricLabel}
        </p>
      </div>
    </section>

    <!-- Content -->
    <article class="pb-12 px-6 md:px-8 max-w-2xl mx-auto prose prose-gray dark:prose-invert prose-headings:font-semibold prose-p:text-base prose-p:text-gray-600 dark:prose-p:text-gray-400 prose-li:text-gray-600 dark:prose-li:text-gray-400">
      <Content />
    </article>

    <!-- CTA -->
    <section class="py-12 px-6 md:px-8 max-w-2xl mx-auto border-t border-gray-200 dark:border-gray-800">
      <div class="p-6 border border-gray-200 dark:border-gray-800">
        <p class="font-semibold text-gray-900 dark:text-white mb-2">
          Facing similar challenges?
        </p>
        <p class="text-base text-gray-600 dark:text-gray-400 mb-4">
          Let's talk about how I can help.
        </p>
        <a
          href="https://cal.com/ryan-eberhard-6jsjkn/30min"
          target="_blank"
          rel="noopener noreferrer"
          class="text-sm text-primary hover:underline"
        >
          Book a call â†’
        </a>
      </div>
    </section>
  </main>
</Layout>
