---
import Layout from "../../layouts/Layout.astro";
import { getCollection } from "astro:content";
import { ArrowLeft, Calendar } from "lucide-astro";

export async function getStaticPaths() {
  const posts = await getCollection("log");
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();

function formatDate(date: Date) {
  return date.toLocaleDateString("en-US", {
    year: "numeric",
    month: "long",
    day: "numeric",
  });
}
---

<Layout title={`${post.data.title} | Log | Gauges Green`} description={post.data.description}>
  <main class="min-h-screen bg-white dark:bg-gray-900 transition-colors duration-300">
    <!-- Back link -->
    <div class="py-6 px-4 md:px-8 max-w-3xl mx-auto">
      <a
        href="/log"
        class="inline-flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400 hover:text-primary transition-colors"
      >
        <ArrowLeft class="w-4 h-4" />
        <span data-i18n="log_back">Back to Log</span>
      </a>
    </div>

    <!-- Header -->
    <section class="py-8 px-4 md:px-8 max-w-3xl mx-auto">
      <time class="text-sm text-gray-500 dark:text-gray-500">
        {formatDate(post.data.date)}
      </time>
      <h1 class="text-2xl text-gray-900 dark:text-white mt-2 mb-4">
        {post.data.title}
      </h1>
      {post.data.tags.length > 0 && (
        <div class="flex gap-2">
          {post.data.tags.map((tag) => (
            <span class="text-xs px-2 py-1 rounded-full bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400">
              {tag}
            </span>
          ))}
        </div>
      )}
    </section>

    <!-- Content -->
    <article class="py-8 px-4 md:px-8 max-w-3xl mx-auto prose prose-sm dark:prose-invert prose-h2:text-2xl prose-h2:mt-10 prose-h2:mb-4 prose-p:text-gray-600 dark:prose-p:text-gray-400 prose-li:text-gray-600 dark:prose-li:text-gray-400 prose-strong:text-gray-900 dark:prose-strong:text-white prose-a:text-primary prose-a:no-underline hover:prose-a:underline">
      <Content />
    </article>

    <!-- CTA -->
    <section class="py-10 px-4 md:px-8 max-w-3xl mx-auto text-center border-t border-gray-200 dark:border-gray-800 mt-12">
      <h2 class="text-xl text-gray-900 dark:text-white mb-4" data-i18n="log_cta_title">
        Want to discuss?
      </h2>
      <p class="text-sm text-gray-600 dark:text-gray-400 mb-6" data-i18n="log_cta_desc">
        I'm always happy to chat about product, growth, or what I'm building.
      </p>
      <a
        href="https://cal.com/ryan-eberhard-6jsjkn/30min"
        target="_blank"
        rel="noopener noreferrer"
        class="text-sm text-primary hover:underline font-medium"
        data-i18n="log_cta_button"
      >
        Book a call â†’
      </a>
    </section>
  </main>
</Layout>
